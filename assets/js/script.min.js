"use strict";const HOVERTIME=300,ANIMTIME=800,ROOTS=getComputedStyle(document.documentElement);let isAnimating=!1;const header=document.querySelector(".header");header&&(headerInit(),headerBackgroundColor(),clearBtnInit(),document.addEventListener("scroll",()=>requestAnimationFrame(()=>headerBackgroundColor())),document.querySelector(".header__cat-button-block")?desktopCategoryPopupInit():modileCategoryPopupInit());let sliderArr=[],sliderItemsInView=0;function headerBackgroundColor(){pageYOffset>0?header.classList.add("fill"):header.classList.remove("fill")}function headerInit(){const e=header.querySelector(".burger-button"),t=document.querySelector(".menu__popup"),i=header.querySelector(".to-search__button"),n=document.querySelector(".search__popup");e.addEventListener("click",()=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,300),showPopup(".menu__popup"),hideHeader())}),t.addEventListener("click",e=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,300),e.target.closest(".popup__body")||(hidePopup(".menu__popup"),showHeader()))}),i.addEventListener("click",()=>{if(isAnimating)return;isAnimating=!0,setTimeout(()=>isAnimating=!1,300);const e=n.querySelector(".input-text");showPopup(".search__popup"),hideHeader(),setTimeout(()=>e.focus(),300)}),n.addEventListener("click",e=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,300),e.target.closest(".popup__body")||(hidePopup(".search__popup"),showHeader()))})}function hideHeader(){header.classList.add("animating"),header.style.transform="translateY(-100%)",setTimeout(()=>{header.classList.remove("animating")},300)}function showHeader(){header.classList.add("animating"),header.style.transform="",setTimeout(()=>{header.classList.remove("animating")},300)}function desktopCategoryPopupInit(){const e=document.querySelector(".header__cat-button-block"),t=document.querySelector(".cat-popup__block");e.addEventListener("mouseenter",()=>{isMobile()||showPopup(".categories__popup")}),e.addEventListener("mouseleave",()=>{isMobile()||hidePopup(".categories__popup")}),t.addEventListener("mouseenter",()=>{isMobile()||showPopup(".categories__popup")}),t.addEventListener("mouseleave",()=>{isMobile()||hidePopup(".categories__popup")})}function modileCategoryPopupInit(){const e=document.querySelector(".activity__filter-button"),t=document.querySelector(".filter-popup");e.addEventListener("click",()=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,300),showPopup(".filter-popup"),hideHeader())}),t.addEventListener("click",e=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,300),e.target.closest(".popup__body")||(hidePopup(".filter-popup"),showHeader()))})}function showPopup(e){const t=document.querySelector(e);lockScroll(),t.classList.add("show")}function hidePopup(e){const t=document.querySelector(e);unlockScroll(),t.classList.remove("show")}function isClosePopup(e,t){t.target.closest(".popup__body")||hidePopup(e)}function lockScroll(){const e=document.documentElement,t=document.querySelector(".header");let i=getScrollWidth();e.style.overflow="hidden",e.style.paddingRight=i+"px",t.style.paddingRight=i+"px"}function unlockScroll(){const e=document.documentElement,t=document.querySelector(".header");e.style.overflow="",e.style.paddingRight="",t.style.paddingRight=""}function sliderInit(){const e=document.querySelectorAll(".slider");sliderItemsInView=ROOTS.getPropertyValue("--slide-count"),e.forEach(e=>{const t=e.querySelector(".slider__left-button"),i=e.querySelector(".slider__right-button");e.step=0,sliderArr.push(e),t.addEventListener("click",()=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,800),slideLeft(t))}),i.addEventListener("click",()=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,800),slideRight(i))}),sliderPointsInit(e)})}function sliderPointsInit(e){const t=e.querySelectorAll(".slider__item"),i=e.querySelector(".slider__points-block");i.innerHTML="";const n=Math.ceil(t.length/ROOTS.getPropertyValue("--slide-count"));e.allStep=n-1;for(let e=0;e<n;e++){const e=document.createElement("span");e.className="slider-point",i.append(e)}updateSliderPoints(e)}function slideLeft(e){const t=e.closest(".slider"),i=t.querySelector(".slider-tape");let n=getTranslateX(i);const o=ROOTS.getPropertyValue("--slide-count");t.step--,t.step+1===0?(t.step=t.allStep,n+=offsetSlide(t,"last")):t.step+1===1?n=0:n+=offsetSlide(t,t.step*o+(o-1)),updateSliderPoints(t),i.style.transform=`translateX(${n}px)`}function slideRight(e){const t=e.closest(".slider"),i=t.querySelector(".slider-tape");let n=getTranslateX(i);const o=ROOTS.getPropertyValue("--slide-count");t.step++,t.step-1===t.allStep?(t.step=0,n=0):t.step===t.allStep?n+=offsetSlide(t,"last"):n+=offsetSlide(t,t.step*o+(o-1)),updateSliderPoints(t),i.style.transform=`translateX(${n}px)`}function updateSliderPoints(e){const t=e.querySelectorAll(".slider-point");let i=0;for(let n of t)n.classList.contains("focus")&&n.classList.remove("focus"),i===e.step&&n.classList.add("focus"),i++}function updateSliderStep(e){e.step=Math.floor(e.step/sliderItemsInView)}function clearBtnInit(){document.querySelectorAll(".clear-button").forEach(e=>e.addEventListener("click",t=>{t.preventDefault();e.parentElement.querySelector(".input").value=""}))}function formInit(){const e=document.querySelector(".form"),t=document.querySelector(".success__popup");e.addEventListener("submit",t=>formSend(t,e)),t.addEventListener("click",e=>{isAnimating||(isAnimating=!0,setTimeout(()=>isAnimating=!1,300),e.target.closest(".popup__body")||(hidePopup(".success__popup"),showHeader()))}),e.querySelector(".input-file")&&inputFileInit(e)}function inputFileInit(e){e.querySelector(".input-file").addEventListener("change",()=>fileInputStatus(e))}function fileInputStatus(e){const t=e.querySelector(".input-file"),i=e.querySelector(".label-file"),n=i.querySelector(".icon");0!=t.files.length?(i.classList.add("fill"),n.className="joint-upload-fill icon"):(i.classList.remove("fill"),n.className="joint-upload icon")}function formSend(e,t){if(e.preventDefault(),formValidate(t))return;let i=jointAjax.ajaxurl,n="",o=new FormData(t);if(t.classList.contains("form-contacts"))n="contacts";else{if(!t.classList.contains("form-send"))return;o.append("file",t.file.files),n="send"}o.append("action",n),fetch(i,{method:"POST",body:o}).then(t.reset()).then(isFileForm(t)).then(showPopup(".success__popup")).then(hideHeader()).catch(e=>{e.json().then(e=>{alert(e.message)})})}function formValidate(e){const t=e.querySelectorAll(".require");let i=!1;return t.forEach(e=>{""===e.value&&(e.classList.add("void"),setTimeout(()=>e.classList.remove("void"),2e3),i=!0)}),i}function isFileForm(e){e.file&&fileInputStatus(e)}function getScrollWidth(){return innerWidth-document.documentElement.clientWidth}function isMobile(){return!(document.documentElement.clientWidth>1e3)}function getTranslateX(e){let t=window.getComputedStyle(e);return new WebKitCSSMatrix(t.transform).e}function offsetSlide(e,t){const i=e.querySelector(".slider-body"),n=e.querySelector(".slider-tape"),o="last"===t?n.lastElementChild:n.querySelectorAll(".slider__item")[t];return i.getBoundingClientRect().right-o.getBoundingClientRect().right}function removeLetters(e){return+e.replace(/\D/g,"")}document.querySelector(".slider")&&(sliderInit(),window.addEventListener("resize",()=>{if(sliderItemsInView!==ROOTS.getPropertyValue("--slide-count")){sliderItemsInView=ROOTS.getPropertyValue("--slide-count");for(let e of sliderArr)updateSliderStep(e),sliderPointsInit(e)}})),document.querySelector(".form")&&formInit();